<div class="relevance-settings">
  <div class="settings-header">
    <h4>Codex Relevance Settings</h4>
    <p class="description">
      Choose which entries should always be sent to the AI (Global) 
      and which should only be included when relevant.
    </p>
  </div>
  
  <div class="categories" *ngIf="codex">
    <div class="category-section" *ngFor="let category of codex.categories">
      <h5>{{ category.title }}</h5>
      
      <div class="entries-list">
        <div class="entry-item" *ngFor="let entry of category.entries">
          <label class="checkbox-label">
            <input 
              type="checkbox" 
              [(ngModel)]="globalIncludes[entry.id]"
              (change)="updateGlobalInclude(entry.id, $event)"
            />
            <span class="entry-title">{{ entry.title }}</span>
            <span class="entry-type" *ngIf="entry.metadata?.['storyRole']">
              ({{ entry.metadata?.['storyRole'] }})
            </span>
          </label>
          
          <div class="aliases" *ngIf="entry.metadata?.['aliases']">
            <input 
              type="text" 
              [ngModel]="entry.metadata?.['aliases'] || ''"
              (ngModelChange)="updateEntryAliases(entry.id, $event)"
              (blur)="updateAliases(entry.id, $event)"
              placeholder="Aliase (kommagetrennt)"
              class="alias-input"
            />
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <div class="settings-footer">
    <div class="info">
      <strong>Tipp:</strong> Markiere nur die wichtigsten Charaktere und Orte als global. 
      Zu viele globale Einträge können die AI-Kosten erhöhen und die Qualität beeinträchtigen.
    </div>
  </div>
</div>