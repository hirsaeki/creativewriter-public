<div class="demo-container">
  <h3>Codex Relevance Demo</h3>
  <p class="description">
    Diese Demo zeigt, wie die AI relevante Codex-Einträge basierend auf dem Kontext auswählt.
  </p>
  
  <div class="demo-content">
    <div class="left-panel">
      <h4>Sample Codex Entries</h4>
      <div class="sample-entries">
        <div class="entry-card" *ngFor="let entry of sampleEntries">
          <div class="entry-header">
            <strong>{{ entry.title }}</strong>
            <span class="category">{{ entry.category }}</span>
            <span class="importance" [class]="entry.importance">{{ entry.importance }}</span>
          </div>
          <div class="entry-content">{{ entry.content }}</div>
          <div class="entry-meta">
            <span *ngIf="entry.aliases.length">Aliase: {{ entry.aliases.join(', ') }}</span>
            <span *ngIf="entry.keywords.length">Keywords: {{ entry.keywords.join(', ') }}</span>
          </div>
          <div class="relevance-score" *ngIf="relevanceScores[entry.id]">
            <strong>Score: {{ relevanceScores[entry.id].score.toFixed(2) }}</strong>
            <ul>
              <li *ngFor="let reason of relevanceScores[entry.id].reasons">{{ reason }}</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
    
    <div class="right-panel">
      <h4>Test Context</h4>
      <div class="form-group">
        <label for="scene-text">Szenen-Text:</label>
        <textarea 
          id="scene-text"
          [(ngModel)]="testContext"
          rows="6"
          placeholder="Gib hier den aktuellen Szenen-Text ein..."
        ></textarea>
      </div>
      
      <div class="form-group">
        <label for="beat-prompt">Beat Prompt:</label>
        <textarea 
          id="beat-prompt"
          [(ngModel)]="testPrompt"
          rows="3"
          placeholder="Gib hier den Beat-Prompt ein..."
        ></textarea>
      </div>
      
      <button (click)="analyzeRelevance()" class="analyze-btn">
        Relevanz analysieren
      </button>
      
      <div class="results" *ngIf="selectedEntries">
        <h4>Selected Entries ({{ selectedEntries.length }}):</h4>
        <div class="selected-entry" *ngFor="let entry of selectedEntries">
          <strong>{{ entry.title }}</strong>
          <span class="score">Score: {{ getScore(entry.id) }}</span>
        </div>
        
        <div class="token-info">
          <strong>Estimated Tokens:</strong> ~{{ estimatedTokens }}
        </div>
      </div>
    </div>
  </div>
</div>