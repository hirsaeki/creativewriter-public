<ion-header>
  <ion-toolbar>
    <ion-title>Create Scene from Outline</ion-title>
    <ion-buttons slot="end">
      <ion-button fill="clear" (click)="dismiss()" [disabled]="generating">
        <ion-icon name="close-outline" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
  </ion-header>

<ion-content class="ion-padding">
  <ion-item lines="none">
    <ion-label position="stacked">AI Model</ion-label>
    <app-model-selector [(model)]="selectedModel" [placeholder]="'Select AI model'" [appendTo]="'body'"></app-model-selector>
  </ion-item>

  <ion-item>
    <ion-label position="stacked">Outline</ion-label>
    <ion-textarea
      [(ngModel)]="outline"
      placeholder="Describe the scene outline: setting, characters, key beats, tone..."
      [autoGrow]="true"
      [maxlength]="5000"
      [counter]="true"
    ></ion-textarea>
  </ion-item>

  <div class="controls">
    <ion-item>
      <ion-label>Target word count: {{ wordCount }}</ion-label>
      <ion-range min="200" max="1500" step="50" snaps="true" [(ngModel)]="wordCount"></ion-range>
    </ion-item>

    <ion-item>
      <ion-label>Temperature: {{ temperature }}</ion-label>
      <ion-range min="0" max="1.5" step="0.1" snaps="true" [(ngModel)]="temperature"></ion-range>
    </ion-item>

    <ion-item>
      <ion-label>Include story outline/context</ion-label>
      <ion-toggle [(ngModel)]="includeStoryOutline"></ion-toggle>
    </ion-item>

    <ion-item *ngIf="includeStoryOutline">
      <ion-label>Use full text (otherwise summaries)</ion-label>
      <ion-toggle [(ngModel)]="useFullStoryContext"></ion-toggle>
    </ion-item>

    <ion-item>
      <ion-label>Include Codex (characters, places, etc.)</ion-label>
      <ion-toggle [(ngModel)]="includeCodex"></ion-toggle>
    </ion-item>
  </div>

  <div class="error" *ngIf="error">{{ error }}</div>

  <div class="generating" *ngIf="generating">
    <ion-spinner name="dots"></ion-spinner>
    <div>Generating scene from outline...</div>
  </div>
</ion-content>

<ion-footer>
  <ion-toolbar>
    <ion-buttons slot="end">
      <ion-button color="primary" (click)="create()" [disabled]="generating">
        <ion-icon name="sparkles-outline" slot="start"></ion-icon>
        Create Scene
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-footer>

