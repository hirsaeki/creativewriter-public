    <ion-toolbar class="cyberpunk-toolbar">
      <ion-buttons slot="end">
        <ion-chip color="medium" class="logs-count-chip">
          <ion-label>{{ logs.length }} Logs</ion-label>
        </ion-chip>
        <ion-button color="danger" (click)="clearLogs()" [disabled]="logs.length === 0" class="clear-button">
          <ion-icon name="trash" slot="icon-only"></ion-icon>
        </ion-button>
      </ion-buttons>
    </ion-toolbar>

    <ion-list class="logs-list">
      <ion-card *ngFor="let log of logs" 
                [class.success-card]="log.status === 'success'"
                [class.error-card]="log.status === 'error'"
                [class.pending-card]="log.status === 'pending'"
                [class.aborted-card]="log.status === 'aborted'">
        
        <ion-item button detail="false" (click)="toggleExpand(log.id)" class="log-header">
          <ion-icon 
            [name]="getStatusIcon(log.status)" 
            [color]="getStatusColor(log.status)"
            slot="start"
            class="status-icon">
          </ion-icon>
          
          <ion-label>
            <h2>
              <ion-text>{{ formatTime(log.timestamp) }}</ion-text>
              <ion-badge color="primary" class="model-badge">{{ log.model }}</ion-badge>
              <ion-badge *ngIf="log.apiProvider" [color]="getProviderColor(log.apiProvider)" class="provider-badge">
                {{ log.apiProvider }}
              </ion-badge>
              <ion-badge *ngIf="log.streamingMode" color="secondary" class="streaming-badge">
                <ion-icon name="radio-outline"></ion-icon>
                Streaming
              </ion-badge>
            </h2>
            <p>
              <ion-text color="medium">{{ log.endpoint }}</ion-text>
              <ion-badge *ngIf="log.httpStatus" [color]="getHttpStatusColor(log.httpStatus)" class="status-badge">
                {{ log.httpStatus }}
              </ion-badge>
            </p>
            <p>
              <ion-chip color="medium" class="meta-chip">
                <ion-icon name="document-text-outline"></ion-icon>
                <ion-label>{{ log.wordCount }} words</ion-label>
              </ion-chip>
              <ion-chip color="medium" class="meta-chip">
                <ion-icon name="code-slash-outline"></ion-icon>
                <ion-label>{{ log.maxTokens }} tokens</ion-label>
              </ion-chip>
              <ion-chip color="medium" class="meta-chip" *ngIf="log.duration">
                <ion-icon name="time-outline"></ion-icon>
                <ion-label>{{ log.duration }}ms</ion-label>
              </ion-chip>
              <ion-chip *ngIf="log.retryCount && log.retryCount > 0" color="warning" class="meta-chip">
                <ion-icon name="refresh-outline"></ion-icon>
                <ion-label>{{ log.retryCount }} Retry{{ log.retryCount > 1 ? 's' : '' }}</ion-label>
              </ion-chip>
              <ion-chip *ngIf="log.networkInfo?.effectiveType && log.networkInfo?.effectiveType !== 'unknown'" color="tertiary" class="meta-chip">
                <ion-icon name="globe-outline"></ion-icon>
                <ion-label>{{ log.networkInfo?.effectiveType }}</ion-label>
              </ion-chip>
            </p>
          </ion-label>
          
          <ion-icon 
            [name]="expandedLogs.has(log.id) ? 'chevron-down' : 'chevron-forward'"
            slot="end">
          </ion-icon>
        </ion-item>
        
        <ion-card-content *ngIf="expandedLogs.has(log.id)" class="log-details">
          <!-- Main Content Section -->
          <ion-accordion-group>
            <!-- Prompt -->
            <ion-accordion value="prompt">
              <ion-item slot="header" color="light">
                <ion-icon name="document-text-outline" slot="start"></ion-icon>
                <ion-label>
                  <h3>Prompt</h3>
                  <p>{{ log.prompt.length }} characters</p>
                </ion-label>
                <ion-button 
                  fill="clear" 
                  size="small" 
                  slot="end"
                  (click)="copyToClipboard(log.prompt, $event)"
                  title="Prompt kopieren">
                  <ion-icon name="copy-outline" slot="icon-only"></ion-icon>
                </ion-button>
              </ion-item>
              <div class="accordion-content" slot="content">
                <pre class="content-pre prompt-content">{{ log.prompt }}</pre>
              </div>
            </ion-accordion>
            
            <!-- Response -->
            <ion-accordion value="response" *ngIf="log.response">
              <ion-item slot="header" color="light">
                <ion-icon name="checkmark-circle-outline" slot="start" color="success"></ion-icon>
                <ion-label>
                  <h3>Response</h3>
                  <p>{{ log.response.length }} characters, {{ getWordCount(log.response) }} words</p>
                </ion-label>
                <ion-button 
                  fill="clear" 
                  size="small" 
                  slot="end"
                  (click)="copyToClipboard(log.response, $event)"
                  title="Response kopieren">
                  <ion-icon name="copy-outline" slot="icon-only"></ion-icon>
                </ion-button>
              </ion-item>
              <div class="accordion-content" slot="content">
                <pre class="content-pre response-content">{{ log.response }}</pre>
              </div>
            </ion-accordion>
            
            <!-- Error -->
            <ion-accordion value="error" *ngIf="log.error">
              <ion-item slot="header" color="light">
                <ion-icon name="warning-outline" slot="start" color="danger"></ion-icon>
                <ion-label>
                  <h3>Error Details</h3>
                  <p>{{ log.error.length }} characters</p>
                </ion-label>
              </ion-item>
              <div class="accordion-content" slot="content">
                <pre class="content-pre error-content">{{ log.error }}</pre>
                
                <!-- Additional Error Details -->
                <div *ngIf="log.errorDetails" class="debug-info-section">
                  <h4><ion-icon name="bug-outline"></ion-icon> Error Analysis</h4>
                  <pre class="debug-info">{{ formatJson(log.errorDetails) }}</pre>
                </div>
              </div>
            </ion-accordion>
            
            <!-- Request Details -->
            <ion-accordion value="request-details" *ngIf="log.requestDetails">
              <ion-item slot="header" color="light">
                <ion-icon name="settings-outline" slot="start" color="primary"></ion-icon>
                <ion-label>
                  <h3>Request Configuration</h3>
                  <p>API parameters and settings</p>
                </ion-label>
              </ion-item>
              <div class="accordion-content" slot="content">
                <div class="debug-info-section">
                  <h4><ion-icon name="cog-outline"></ion-icon> API Configuration</h4>
                  <div class="config-grid">
                    <div class="config-item" *ngIf="log.requestDetails.temperature !== undefined">
                      <ion-label>Temperature:</ion-label>
                      <ion-badge color="tertiary">{{ log.requestDetails.temperature }}</ion-badge>
                    </div>
                    <div class="config-item" *ngIf="log.requestDetails.topP !== undefined">
                      <ion-label>Top P:</ion-label>
                      <ion-badge color="tertiary">{{ log.requestDetails.topP }}</ion-badge>
                    </div>
                    <div class="config-item" *ngIf="log.requestDetails.contentsLength">
                      <ion-label>Contents Length:</ion-label>
                      <ion-badge color="medium">{{ log.requestDetails.contentsLength }}</ion-badge>
                    </div>
                    <div class="config-item" *ngIf="log.requestDetails.safetySettings">
                      <ion-label>Safety Settings:</ion-label>
                      <ion-badge color="medium">{{ log.requestDetails.safetySettings }}</ion-badge>
                    </div>
                    <div class="config-item" *ngIf="log.requestDetails.messagesFormat">
                      <ion-label>Message Format:</ion-label>
                      <ion-badge color="secondary">{{ log.requestDetails.messagesFormat }}</ion-badge>
                    </div>
                    <div class="config-item" *ngIf="log.requestDetails.streamingUrl">
                      <ion-label>Streaming URL:</ion-label>
                      <ion-text class="url-text">{{ log.requestDetails.streamingUrl }}</ion-text>
                    </div>
                  </div>
                  
                  <!-- Full Debug Info -->
                  <div *ngIf="log.requestDetails.debugInfo" class="debug-subsection">
                    <h5><ion-icon name="bug-outline"></ion-icon> Debug Information</h5>
                    <pre class="debug-info">{{ formatJson(log.requestDetails.debugInfo) }}</pre>
                  </div>
                </div>
              </div>
            </ion-accordion>
            
            <!-- Network Information -->
            <ion-accordion value="network-info" *ngIf="hasNetworkInfo(log)">
              <ion-item slot="header" color="light">
                <ion-icon name="globe-outline" slot="start" color="success"></ion-icon>
                <ion-label>
                  <h3>Network Information</h3>
                  <p>Connection and performance data</p>
                </ion-label>
              </ion-item>
              <div class="accordion-content" slot="content">
                <div class="debug-info-section">
                  <h4><ion-icon name="speedometer-outline"></ion-icon> Connection Details</h4>
                  <div class="config-grid">
                    <div class="config-item" *ngIf="log.networkInfo?.connectionType">
                      <ion-label>Connection Type:</ion-label>
                      <ion-badge color="success">{{ log.networkInfo?.connectionType }}</ion-badge>
                    </div>
                    <div class="config-item" *ngIf="log.networkInfo?.effectiveType">
                      <ion-label>Effective Type:</ion-label>
                      <ion-badge color="success">{{ log.networkInfo?.effectiveType }}</ion-badge>
                    </div>
                    <div class="config-item" *ngIf="log.networkInfo?.downlink">
                      <ion-label>Downlink:</ion-label>
                      <ion-badge color="tertiary">{{ log.networkInfo?.downlink }} Mbps</ion-badge>
                    </div>
                    <div class="config-item" *ngIf="log.networkInfo?.rtt">
                      <ion-label>RTT:</ion-label>
                      <ion-badge color="tertiary">{{ log.networkInfo?.rtt }}ms</ion-badge>
                    </div>
                  </div>
                </div>
              </div>
            </ion-accordion>
            
            <!-- Prompt Feedback -->
            <ion-accordion value="prompt-feedback" *ngIf="hasPromptFeedback(log)">
              <ion-item slot="header" color="light">
                <ion-icon name="shield-checkmark-outline" slot="start" color="warning"></ion-icon>
                <ion-label>
                  <h3>Prompt Feedback</h3>
                  <p>Gemini API prompt analysis and safety ratings</p>
                </ion-label>
              </ion-item>
              <div class="accordion-content" slot="content">
                <div class="debug-info-section">
                  <h4><ion-icon name="warning-outline"></ion-icon> Prompt Safety Analysis
                    <span *ngIf="getPromptFeedback(log)?.synthetic" style="font-size: 0.8em; color: var(--ion-color-medium); margin-left: 1rem;">
                      ({{ getPromptFeedback(log)?.note || 'Generated from response safety ratings' }})
                    </span>
                  </h4>
                  
                  <!-- Block Reason if present -->
                  <div *ngIf="getPromptFeedback(log)?.blockReason" class="alert-section">
                    <div class="alert-box blocked">
                      <ion-icon name="stop-circle-outline"></ion-icon>
                      <strong>Prompt Blocked:</strong> {{ getPromptFeedback(log)?.blockReason }}
                    </div>
                  </div>
                  
                  <!-- Safety Ratings -->
                  <div *ngIf="getPromptFeedback(log)?.safetyRatings?.length" class="safety-ratings-grid">
                    <h5><ion-icon name="shield-outline"></ion-icon> Safety Ratings</h5>
                    <div class="safety-rating" 
                         *ngFor="let rating of getPromptFeedback(log)?.safetyRatings"
                         [class.high-risk]="rating.probability === 'HIGH'"
                         [class.medium-risk]="rating.probability === 'MEDIUM'"
                         [class.low-risk]="rating.probability === 'LOW' || rating.probability === 'NEGLIGIBLE'">
                      <div class="rating-category">
                        <ion-label>{{ formatSafetyCategory(rating.category) }}</ion-label>
                      </div>
                      <div class="rating-probability">
                        <ion-badge [color]="getSafetyColor(rating.probability)">
                          {{ rating.probability || 'UNKNOWN' }}
                        </ion-badge>
                      </div>
                    </div>
                  </div>
                  
                  <!-- Raw Prompt Feedback Data -->
                  <div class="debug-subsection">
                    <h5><ion-icon name="code-outline"></ion-icon> Raw Prompt Feedback</h5>
                    <pre class="debug-info">{{ formatJson(getPromptFeedback(log)) }}</pre>
                  </div>
                </div>
              </div>
            </ion-accordion>

            <!-- Candidate Safety Ratings -->
            <ion-accordion value="candidate-safety" *ngIf="hasCandidateSafetyRatings(log)">
              <ion-item slot="header" color="light">
                <ion-icon name="shield-half-outline" slot="start" color="success"></ion-icon>
                <ion-label>
                  <h3>Candidate Safety Ratings</h3>
                  <p>Safety analysis of generated content</p>
                </ion-label>
              </ion-item>
              <div class="accordion-content" slot="content">
                <div class="debug-info-section">
                  <h4><ion-icon name="checkmark-circle-outline"></ion-icon> Generated Content Safety Analysis</h4>
                  
                  <!-- Finish Reason if present -->
                  <div *ngIf="getCandidateFinishReason(log)" class="alert-section">
                    <div class="alert-box" [ngClass]="{'blocked': getCandidateFinishReason(log) === 'SAFETY', 'warning': getCandidateFinishReason(log) === 'OTHER'}">
                      <ion-icon [name]="getCandidateFinishReason(log) === 'SAFETY' ? 'stop-circle-outline' : 'warning-outline'"></ion-icon>
                      <strong>Finish Reason:</strong> {{ getCandidateFinishReason(log) }}
                      <span *ngIf="getCandidateFinishReason(log) === 'SAFETY'" style="margin-left: 0.5rem; font-weight: normal;">
                        (Content generation stopped due to safety filters)
                      </span>
                    </div>
                  </div>
                  
                  <!-- Safety Ratings -->
                  <div *ngIf="getCandidateSafetyRatings(log)?.length" class="safety-ratings-grid">
                    <h5><ion-icon name="shield-outline"></ion-icon> Safety Ratings</h5>
                    <div class="safety-rating" 
                         *ngFor="let rating of getCandidateSafetyRatings(log)"
                         [class.high-risk]="rating.probability === 'HIGH'"
                         [class.medium-risk]="rating.probability === 'MEDIUM'"
                         [class.low-risk]="rating.probability === 'LOW' || rating.probability === 'NEGLIGIBLE'">
                      <div class="rating-category">
                        <ion-label>{{ formatSafetyCategory(rating.category) }}</ion-label>
                      </div>
                      <div class="rating-probability">
                        <ion-badge [color]="getSafetyColor(rating.probability)">
                          {{ rating.probability || 'UNKNOWN' }}
                        </ion-badge>
                      </div>
                    </div>
                  </div>
                  
                  <!-- Raw Candidate Safety Data -->
                  <div class="debug-subsection">
                    <h5><ion-icon name="code-outline"></ion-icon> Raw Candidate Safety Data</h5>
                    <pre class="debug-info">{{ formatJson({
                      candidateSafetyRatings: getCandidateSafetyRatings(log),
                      finishReason: getCandidateFinishReason(log)
                    }) }}</pre>
                  </div>
                </div>
              </div>
            </ion-accordion>

            <!-- Response Headers -->
            <ion-accordion value="response-headers" *ngIf="log.responseHeaders">
              <ion-item slot="header" color="light">
                <ion-icon name="cloud-outline" slot="start" color="tertiary"></ion-icon>
                <ion-label>
                  <h3>Response Headers</h3>
                  <p>HTTP response metadata</p>
                </ion-label>
              </ion-item>
              <div class="accordion-content" slot="content">
                <div class="debug-info-section">
                  <h4><ion-icon name="information-circle-outline"></ion-icon> HTTP Headers</h4>
                  <pre class="debug-info">{{ formatJson(log.responseHeaders) }}</pre>
                </div>
              </div>
            </ion-accordion>
            
            <!-- Technical Details -->
            <ion-accordion value="technical" *ngIf="hasTechnicalDetails(log)">
              <ion-item slot="header" color="light">
                <ion-icon name="bug-outline" slot="start" color="warning"></ion-icon>
                <ion-label>
                  <h3>Technical Details</h3>
                  <p>Request ID, timestamps, and internal data</p>
                </ion-label>
              </ion-item>
              <div class="accordion-content" slot="content">
                <div class="debug-info-section">
                  <h4><ion-icon name="information-circle-outline"></ion-icon> Request Metadata</h4>
                  <div class="config-grid">
                    <div class="config-item">
                      <ion-label>Request ID:</ion-label>
                      <ion-text class="monospace-text">{{ log.id }}</ion-text>
                    </div>
                    <div class="config-item">
                      <ion-label>Timestamp:</ion-label>
                      <ion-text class="monospace-text">{{ log.timestamp.toISOString() }}</ion-text>
                    </div>
                    <div class="config-item" *ngIf="log.requestDetails?.requestId">
                      <ion-label>Internal Request ID:</ion-label>
                      <ion-text class="monospace-text">{{ log.requestDetails!.requestId }}</ion-text>
                    </div>
                    <div class="config-item" *ngIf="log.httpStatus">
                      <ion-label>HTTP Status:</ion-label>
                      <ion-badge [color]="getHttpStatusColor(log.httpStatus)">{{ log.httpStatus }}</ion-badge>
                    </div>
                  </div>
                </div>
              </div>
            </ion-accordion>
          </ion-accordion-group>
        </ion-card-content>
      </ion-card>
      
      <ion-card *ngIf="logs.length === 0" class="no-logs-card">
        <ion-card-content class="ion-text-center">
          <ion-text color="medium">
            <p>No AI requests logged yet.</p>
          </ion-text>
        </ion-card-content>
      </ion-card>
    </ion-list>